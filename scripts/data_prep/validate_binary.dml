# Validate ImageNet binary data format
print("Validating ImageNet binary data...");

# Read combined training data
print("Loading combined training data...");
X_train = read("imagenet_data/systemds_ready/train_data_combined.bin", format="binary");
Y_train = read("imagenet_data/systemds_ready/train_labels_combined.bin", format="binary");

# Read validation data
print("Loading validation data...");
X_val = read("imagenet_data/systemds_ready/val_data.bin", format="binary");
Y_val = read("imagenet_data/systemds_ready/val_labels.bin", format="binary");

print("Dataset info:");
print("- Training samples: " + nrow(X_train));
print("- Training features: " + ncol(X_train));
print("- Validation samples: " + nrow(X_val));
print("- Classes: " + ncol(Y_train));

# Validate data ranges
print("Data validation:");
print("- X_train range: [" + min(X_train) + ", " + max(X_train) + "]");
print("- Y_train sum per row: " + mean(rowSums(Y_train)));

print("Binary data validation completed!");